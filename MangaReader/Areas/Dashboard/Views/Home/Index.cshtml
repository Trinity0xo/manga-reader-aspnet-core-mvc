@using MangaReader.ViewModels
@model DashboardContentViewModel


@{
    ViewData["Title"] = "Dashboard";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    var coversFolder = ViewBag.CoversFolder as string;
    var basePath = ViewBag.BasePath as string;
}

<div class="d-flex flex-column gap-3">
    <section>
        <div class="row g-3">
            <div class="col-md-6 col-lg-3">
                <div class="card border-0 text-white bg-primary rounded-0 shadow-sm">
                    <div class="card-body d-flex flex-column gap-2 align-items-center justify-content-center py-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-book-fill" viewBox="0 0 16 16">
                            <path d="M8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783" />
                        </svg>
                        <h5 class="card-title">Truyện</h5>
                        <h2 class="card-text fw-bold">@Model.MangaCount</h2>
                        <hr class="w-100 m-0" />
                        <a asp-area="Dashboard" asp-controller="Mangas" asp-action="Index" class="text-decoration-none text-white">
                            Xem
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="card border-0 text-white bg-success rounded-0 shadow-sm">
                    <div class="card-body d-flex flex-column gap-2 align-items-center justify-content-center py-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                            <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5.784 6A2.24 2.24 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.3 6.3 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1zM4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5" />
                        </svg>
                        <h5 class="card-title">Người dùng</h5>
                        <h2 class="card-text fw-bold">@Model.UserCount</h2>
                        <hr class="w-100 m-0" />
                        <a asp-area="Dashboard" asp-controller="Users" asp-action="Index" class="text-decoration-none text-white">
                            Xem
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="card border-0 text-white bg-warning rounded-0 shadow-sm">
                    <div class="card-body d-flex flex-column gap-2 align-items-center justify-content-center py-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-book-half" viewBox="0 0 16 16">
                            <path d="M8.5 2.687c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783" />
                        </svg>
                        <h5 class="card-title">Chương</h5>
                        <h2 class="card-text fw-bold">@Model.ChapterCount</h2>
                        <hr class="w-100 m-0" />
                        <a asp-area="Dashboard" asp-controller="Chapters" asp-action="Index" class="text-decoration-none text-white">
                            Xem
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-md-6 col-lg-3">
                <div class="card border-0 text-white bg-danger rounded-0 shadow-sm">
                    <div class="card-body d-flex flex-column gap-2 align-items-center justify-content-center py-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bookmark-fill" viewBox="0 0 16 16">
                            <path d="M2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2" />
                        </svg>
                        <h5 class="card-title">Thể loại</h5>
                        <h2 class="card-text fw-bold">@Model.GenreCount</h2>
                        <hr class="w-100 m-0" />
                        <a asp-area="Dashboard" asp-controller="Genres" asp-action="Index" class="text-decoration-none text-white">
                            Xem
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    @if(Model.NewestChapters.Any())
    {
        <section class="d-flex flex-column gap-2">
            <h3 class="mb-0">Chương mới</h3>

            <div class="card rounded-0 p-3 d-flex flex-column gap-3 shadow-sm">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead>
                            <tr>
                                <th>@Html.DisplayNameFor(model => Model.NewestChapters.First().Manga.Cover)</th>
                                <th>@Html.DisplayNameFor(model => Model.NewestChapters.First().Manga.Title)</th>
                                <th>@Html.DisplayNameFor(model => Model.NewestChapters.First().Title)</th>
                                <th>@Html.DisplayNameFor(model => Model.NewestChapters.First().CreatedAt)</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.NewestChapters)
                            {
                                <tr>
                                    <td class="table-col-1">
                                        <img src="@($"/{basePath}/{item.Manga.Slug}/{coversFolder}/{item.Manga.Cover}")" alt="@item.Manga.Cover" style="width: 60px; height: auto;" />
                                    </td>
                                    <td class="table-col-4"><span class="d-inline-block text-truncate mw-100">@item.Manga.Title</span></td>
                                    <td class="table-col-3"><span class="d-inline-block text-truncate mw-100">@item.Title</span></td>
                                    <td class="table-col-2"><span class="d-inline-block text-truncate mw-100">@item.CreatedAt.ToString("yyyy-MM-dd HH:mm")</span></td>
                                    <td class="table-col-2 text-end">
                                        <a class="btn btn-sm btn-success ms-1" asp-area="Dashboard" asp-controller="Chapters" asp-action="Details" asp-route-id="@item.Id">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-left" viewBox="0 0 16 16">
                                                <path fill-rule="evenodd" d="M7.364 3.5a.5.5 0 0 1 .5-.5H14.5A1.5 1.5 0 0 1 16 4.5v10a1.5 1.5 0 0 1-1.5 1.5h-10A1.5 1.5 0 0 1 3 14.5V7.864a.5.5 0 1 1 1 0V14.5a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5v-10a.5.5 0 0 0-.5-.5H7.864a.5.5 0 0 1-.5-.5" />
                                                <path fill-rule="evenodd" d="M0 .5A.5.5 0 0 1 .5 0h5a.5.5 0 0 1 0 1H1.707l8.147 8.146a.5.5 0 0 1-.708.708L1 1.707V5.5a.5.5 0 0 1-1 0z" />
                                            </svg>
                                        </a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>

                <div class="d-flex justify-content-end">
                    <a class="btn btn-primary d-flex justify-content-center align-items-center gap-1" asp-area="Dashboard" asp-controller="Chapters" asp-action="Index">
                        Xem tất cả
                    </a>
                </div>
            </div>
        </section>
    }
</div>